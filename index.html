<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>3D Segmented Sphere Visualization</title>
  <style>
    body { margin: 0; padding: 0; overflow: hidden; background: white; font-family: Arial, sans-serif; }
    #canvas-container { position: absolute; width: 100%; height: 100%; }
    #controls { position: absolute; bottom: 20px; left: 0; right: 0; display: flex; justify-content: center; }
    #toggle-button { padding: 10px 20px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
    #data-panel { position: absolute; bottom: 60px; left: 50%; transform: translateX(-50%); width: 80%; max-width: 500px; max-height: 300px; overflow-y: auto; background: white; border: 1px solid #ddd; border-radius: 4px; padding: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); display: none; }
    #search { width: 100%; padding: 8px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 4px; }
    #data-list { list-style-type: none; padding: 0; margin: 0; }
    #data-list li { padding: 8px; border-bottom: 1px solid #eee; cursor: pointer; }
    #data-list li:hover { background: #f5f5f5; }
    #data-list li:last-child { border-bottom: none; }
  </style>
</head>
<body>
  <div id="canvas-container"></div>
  <div id="controls">
    <button id="toggle-button">Show Data List</button>
  </div>
  <div id="data-panel">
    <input type="text" id="search" placeholder="Search data...">
    <ul id="data-list"></ul>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
  <script>
    // ================= Data List =================
    const dataList = [
      { name: "louwillitb", url: "https://itb.ac.id" },
      { name: "louwillmit", url: "https://www.mit.edu/" },
      // Tambahkan data lainnya sesuai kebutuhan
    ];

    // Warna segmen pakai name sebagai key
    const dataColors = {
      "louwillitb":"#1A284D",
      "louwillmit":"#A31F34",
    };

    // ========== Three.js Setup ==========
    let scene, camera, renderer, controls;
    let segments = [];
    const sphereRadius = 1.5;
    const sphereSegments = 64;

    function init() {
      scene = new THREE.Scene();

      camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
      camera.position.z = 5;

      renderer = new THREE.WebGLRenderer({antialias:true});
      renderer.setSize(window.innerWidth, window.innerHeight);
      renderer.setClearColor(0xffffff);
      document.getElementById('canvas-container').appendChild(renderer.domElement);

      updateSphereSegments();

      controls = new THREE.OrbitControls(camera, renderer.domElement);
      controls.enableDamping = true;
      controls.dampingFactor = 0.25;

      window.addEventListener('resize', onWindowResize, false);
      setupUI();
      animate();
    }

    function updateSphereSegments() {
      segments.forEach(segment => scene.remove(segment.mesh));
      segments = [];

      const dataCount = dataList.length;
      if (dataCount === 0) return;

      const anglePerSegment = (Math.PI*2) / dataCount;

      for (let i=0; i<dataCount; i++) {
        const data = dataList[i];
        const startAngle = i * anglePerSegment;

        const geometry = new THREE.SphereGeometry(
          sphereRadius, sphereSegments, sphereSegments,
          startAngle, anglePerSegment,
          0, Math.PI
        );

        const material = new THREE.MeshBasicMaterial({
          color: new THREE.Color(dataColors[data.name]),
          side: THREE.DoubleSide
        });

        const segment = new THREE.Mesh(geometry, material);
        scene.add(segment);

        segments.push({ mesh: segment, data: data });
      }
    }

    function onWindowResize() {
      camera.aspect = window.innerWidth/window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    }

    function animate() {
      requestAnimationFrame(animate);
      controls.update();
      renderer.render(scene, camera);
    }

    function setupUI() {
      const toggleButton = document.getElementById('toggle-button');
      const dataPanel = document.getElementById('data-panel');
      const searchInput = document.getElementById('search');
      const dataListElement = document.getElementById('data-list');

      dataList.forEach(item => {
        const li = document.createElement('li');
        li.textContent = item.name;
        li.addEventListener('click', () => {
          window.location.href = item.url;
        });
        dataListElement.appendChild(li);
      });

      toggleButton.addEventListener('click', () => {
        if (dataPanel.style.display === 'block') {
          dataPanel.style.display = 'none';
          toggleButton.textContent = 'Show Data List';
        } else {
          dataPanel.style.display = 'block';
          toggleButton.textContent = 'Hide Data List';
        }
      });

      searchInput.addEventListener('input', (e) => {
        const term = e.target.value.toLowerCase();
        Array.from(dataListElement.getElementsByTagName('li')).forEach(item => {
          item.style.display = item.textContent.toLowerCase().includes(term) ? 'block' : 'none';
        });
      });
    }

    // ========== Klik Segmen ==========
    let raycaster = new THREE.Raycaster();
    let mouse = new THREE.Vector2();

    function onDocumentClick(event) {
      event.preventDefault();
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
      raycaster.setFromCamera(mouse, camera);

      const intersects = raycaster.intersectObjects(segments.map(s => s.mesh));
      if (intersects.length > 0) {
        const clickedMesh = intersects[0].object;
        const clickedSegment = segments.find(s => s.mesh === clickedMesh);
        if (clickedSegment) {
          window.location.href = clickedSegment.data.url;
        }
      }
    }
    window.addEventListener('click', onDocumentClick, false);
    // =================================

    init();
  </script>
</body>
</html>